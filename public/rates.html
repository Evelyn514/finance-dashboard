<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>匯率即時行情</title>
  <style>
    body { background: #121212; color: #fff; font-family: sans-serif; padding: 24px; }
    h1 { color: #00bcd4; }
    #datetime { color: #ccc; margin-bottom: 24px; }
    .row { display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
    .card { background: #1e1e1e; border-radius: 8px; padding: 12px; width: 200px; box-shadow: 0 0 8px rgba(0,0,0,0.5); }
    .title { color: #00bcd4; font-size: 14px; margin-bottom: 6px; }
    .price { font-size: 20px; font-weight: bold; }
    .link { color: #00bcd4; font-size: 12px; text-decoration: underline; margin-top: 4px; display: block; }
    iframe { border: none; }
  </style>
</head>
<body>
  <h1>匯率即時行情</h1>
  <div id="datetime"></div>

  <div class="row">
    <div class="card">
      <div class="title">美國十年期公債</div>
      <div class="price" id="US10Y">載入中...</div>
      <a class="link" href="https://www.tradingview.com/symbols/TVC-US10Y/?locale=zh_TW" target="_blank">查看 TradingView</a>
    </div>
    <div class="card">
      <div class="title">美元指數</div>
      <div class="price" id="DXY">載入中...</div>
      <a class="link" href="https://www.tradingview.com/symbols/TVC-DXY/?locale=zh_TW" target="_blank">查看 TradingView</a>
    </div>
  </div>

  <div class="row">
    <div class="card">
      <div class="title">美元/歐元</div>
      <iframe src="https://s.tradingview.com/embed-widget/mini-symbol-overview/?symbol=FX%3AEURUSD&locale=zh_TW&colorTheme=dark" width="200" height="100"></iframe>
    </div>
    <div class="card">
      <div class="title">美元/英鎊</div>
      <iframe src="https://s.tradingview.com/embed-widget/mini-symbol-overview/?symbol=FX%3AGBPUSD&locale=zh_TW&colorTheme=dark" width="200" height="100"></iframe>
    </div>
    <div class="card">
      <div class="title">美元/日圓</div>
      <iframe src="https://s.tradingview.com/embed-widget/mini-symbol-overview/?symbol=FX%3AUSDJPY&locale=zh_TW&colorTheme=dark" width="200" height="100"></iframe>
    </div>
  </div>

  <div class="row">
    <div class="card">
      <div class="title">美元/台幣</div>
      <div class="price" id="USDTWD">載入中...</div>
      <a class="link" href="https://cn.investing.com/currencies/usd-twd" target="_blank">查看 Investing.com</a>
    </div>
    <div class="card">
      <div class="title">美元/人民幣</div>
      <iframe src="https://s.tradingview.com/embed-widget/mini-symbol-overview/?symbol=FX%3AUSDCNH&locale=zh_TW&colorTheme=dark" width="200" height="100"></iframe>
    </div>
    <div class="card">
      <div class="title">美元/韓圜</div>
      <div class="price" id="USDKRW">載入中...</div>
      <a class="link" href="https://cn.investing.com/currencies/usd-krw" target="_blank">查看 Investing.com</a>
    </div>
  </div>

  <div style="text-align: center; margin-top: 40px;">
    <a href="index.html">
      <button style="padding: 10px 20px; font-size: 16px; background-color: #00bcd4; color: white; border: none; border-radius: 5px; cursor: pointer;">
        回主頁
      </button>
    </a>
  </div>

  <script>
    function updateDateTime() {
      const now = new Date();
      const formatted = now.toLocaleString('zh-TW', {
        year: 'numeric', month: '2-digit', day: '2-digit',
        hour: '2-digit', minute: '2-digit', second: '2-digit',
        hour12: false
      }).replace(',', '');
      document.getElementById('datetime').textContent = formatted;
    }

    async function fetchPrice(symbol) {
      try {
        const res = await fetch(`/price/${symbol}`);
        const data = await res.json();
        document.getElementById(symbol).textContent = data.price || '無法取得';
      } catch {
        document.getElementById(symbol).textContent = '錯誤';
      }
    }

    function loadPrices() {
      ['US10Y', 'DXY', 'USDTWD', 'USDKRW'].forEach(fetchPrice);
    }

    updateDateTime();
    loadPrices();
    //setInterval(updateDateTime, 1000);
  </script>
  
</body>
</html>
